#!/bin/sh
set -e

BUILD=$1
CACHE=$2

mkdir -p $BUILD
mkdir -p $CACHE

cd $BUILD

git clone https://github.com/openvenues/libpostal --depth 1 --single-branch --branch=master
cd libpostal/
./bootstrap.sh
LDFLAGS="-L/app/vendor/lib" CFLAGS="-I/app/vendor/include" PKG_CONFIG_PATH="/app/vendor/lib/pkgconfig" ./configure --prefix=/app/vendor/ --datadir=/app/vendor
make
make install
